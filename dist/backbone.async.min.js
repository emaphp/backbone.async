!function(a,b){"function"==typeof define&&define.amd?define(["backbone","underscore"],function(c,d){return b(a,c,d)}):"undefined"!=typeof exports?module.exports=b(a,require("backbone"),require("underscore")):b(a,a.Backbone,a._)}(this,function(a,b,c){var d=function(a,b,c){return function(d,e,f){return a&&a.apply(d,arguments),c._collection?b({collection:d,response:e,options:f}):void b({model:d,response:e,options:f})}},e=function(a,b,d,e){var f,g;return"save"===a?null===b||"object"==typeof b?(f=b,g=d):b&&((f={})[b]=d,g=e):g=b,g=g?c.extend({},g):{},{attrs:f,options:g}},f=function(a){return function(b,c){return b[c]=function(f,g,h){var i=this,j=e(c,f,g,h),k=j.options,l=j.attrs,m=k.success,n=k.error;return new Promise(function(e,f){k.success=d(m,e,b),k.error=d(n,f,b),a[c].apply(i,"save"===c?[l,k]:[k])})},b}},g=function(a,c){return c.reduce(f(a.prototype),{_collection:a===b.Collection})};b.Async=b.Async||{},b.Async.VERSION="0.1.1",b.Async.Model=b.Model.extend(g(b.Model,["fetch","save","destroy"])),b.Async.Collection=b.Collection.extend(g(b.Collection,["fetch"]))});