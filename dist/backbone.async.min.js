!function(a,b){"function"==typeof define&&define.amd?define(["backbone","underscore"],function(c,d){return b(a,c,d)}):"undefined"!=typeof exports?module.exports=b(a,require("backbone"),require("underscore")):b(a,a.Backbone,a._)}(this,function(a,b,c){var d=function(a,b){return function(c,d,e){a&&a.apply(c,arguments),b({model:c,response:d,options:e,collection:c})}},e=function(a,b,d,e){var f,g;return"save"===a?null===b||"object"==typeof b?(f=b,g=d):((f={})[b]=d,g=e):g=b,g=g?c.extend({},obj):{},{attrs:f,options:g}},f=function(a){return function(b,c){return b[c]=function(b,f,g){var h=this,i=e(c,b,f,g),j=i.options,k=i.attrs,l=j.success,m=j.error;return new Promise(function(b,e){j.success=d(l,b),j.error=d(m,e),a[c].apply(h,"save"===c?[k,j]:[j])})},b}},g=function(a,b){return b.reduce(f(a.prototype),{})};b.Async=b.Async||{},b.Async.VERSION="0.1.0",b.Async.Model=b.Model.extend(g(b.Model,["fetch","save","destroy"])),b.Async.Collection=b.Collection.extend(g(b.Collection,["fetch"]))});